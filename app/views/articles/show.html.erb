<%= render 'shared/header' %>

<% if user_signed_in? && current_user.id == @article.user_id %>
  <%= link_to edit_article_path(@article) do %>
    <%= image_tag "edit_img.png", class: "user-edit-img" %>
  <% end %>
  <%= link_to article_path(@article), method: :delete do %>
    <%= image_tag "delete_img.png", class: "user-delete-img" %>
  <% end %>
<% elsif user_signed_in? && @favorite %>
  <%= link_to article_favorite_path(@article), method: :delete do %>
    <%= image_tag "favorite.png", class: "user-favorite-img" %>
  <% end %>
<% elsif user_signed_in? %>
  <%= link_to article_favorites_path(@article), method: :post do %>
    <%= image_tag "unfavorite.png", class: "user-favorite-img" %>
  <% end %>
<% end %>

<% if user_signed_in? && current_user.id != @article.user_id && @good_evaluation %>
  <%= link_to article_good_evaluation_path(@article), method: :delete do %>
    <%= image_tag "good.png", class: "user-good-img" %>
  <% end %>
  <%= link_to article_bad_evaluations_path(@article), method: :post do %>
    <%= image_tag "unbad.png", class: "user-bad-img" %>
  <% end %>
<% elsif user_signed_in? && current_user.id != @article.user_id && @bad_evaluation %>
  <%= link_to article_good_evaluations_path(@article), method: :post do %>
    <%= image_tag "ungood.png", class: "user-good-img" %>
  <% end %>
  <%= link_to article_bad_evaluation_path(@article), method: :delete do %>
    <%= image_tag "bad.png", class: "user-bad-img" %>
  <% end %>
<% elsif user_signed_in? && current_user.id != @article.user_id %>
  <%= link_to article_good_evaluations_path(@article), method: :post do %>
    <%= image_tag "ungood.png", class: "user-good-img" %>
  <% end %>
  <%= link_to article_bad_evaluations_path(@article), method: :post do %>
    <%= image_tag "unbad.png", class: "user-bad-img" %>
  <% end %>
<% end %>

<div class="article-show-content">
  <div class="article-cover-img">
  <% if @article.image.attached? %>
    <%= image_tag @article.image, class: "header-img" %>
  <% else %>
    <%= image_tag "sample_img.jpg", class: "header-img" %>
  <% end %>
  </div>

  <div class="article-main">
    <div class="show-article-title">
      <h1><%= @article.title %></h1>
    </div>

    <div class="article-text">
      <p><%= @article.text %></p>
    </div>

    <div class="article-comments-content">

      <% if user_signed_in? %>
        <div class="comment-content-form">
          <%= form_with model: @comment, url: article_comments_path(@article), local: true do |f| %>
            <h2>この記事に対するコメントを書く</h2>
            <%= f.text_area :text, class:"input-article-comment", placeholder:"コメントを入力", rows:"5", maxlength:"250", wrap:"soft"%>
            <%= f.submit "コメントを送信", class:"comment-submit-btn" %>
          <% end %>
        </div>
      <% end %>

      <% if @comments.length != 0 %>
        <h2 class="comment-title">コメント</h2>
        <ul class=comment-lists>
          <% @comments.each do |comment| %>
            <li class=comment-list>
            <p><%= comment.text %></p>
            <p class="comment-user-name"><%= comment.user.nickname %>さん</p>
              <% if user_signed_in? && comment.user_id == current_user.id %>
              <%= link_to "コメントを削除", article_comment_path(comment), method: :delete, class: "comment-delete" %>
              <% end %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <h2>この記事に対するコメントはまだありません</h2>
      <% end %>
    </div>
  </div>
</div>